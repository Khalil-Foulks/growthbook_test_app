const t={staleTTL:6e4,cacheKey:"gbFeaturesCache",backgroundSync:!0},n={fetch:globalThis.fetch?globalThis.fetch.bind(globalThis):void 0,SubtleCrypto:globalThis.crypto?globalThis.crypto.subtle:void 0,EventSource:globalThis.EventSource};try{globalThis.localStorage&&(n.localStorage=globalThis.localStorage)}catch(t){}const e=new Map;let r=!1;const i=new Map,s=new Map,u=new Map,o=new Set;function c(t){Object.assign(n,t)}function a(n){Object.assign(t,n),t.backgroundSync||_()}async function l(){i.clear(),s.clear(),_(),r=!1,await h()}async function h(){try{if(!n.localStorage)return;await n.localStorage.setItem(t.cacheKey,JSON.stringify(Array.from(i.entries())))}catch(t){}}function f(t){const[n,e]=t.getApiInfo();return["".concat(n,"||").concat(e),n,e]}function d(n,r){const s=r.dateUpdated||"",u=new Date(Date.now()+t.staleTTL),o=i.get(n);if(o&&s&&o.version===s)return o.staleAt=u,void h();i.set(n,{data:r,version:s,staleAt:u}),h();const c=e.get(n);c&&c.forEach((t=>v(t,r)))}async function v(t,e){await(e.encryptedExperiments?t.setEncryptedExperiments(e.encryptedExperiments,void 0,n.SubtleCrypto):t.setExperiments(e.experiments||t.getExperiments())),await(e.encryptedFeatures?t.setEncryptedFeatures(e.encryptedFeatures,void 0,n.SubtleCrypto):t.setFeatures(e.features||t.getFeatures()))}async function w(t){const[e,r,i]=f(t),u=r+"/api/features/"+i;let c=s.get(e);return c||(c=n.fetch(u).then((t=>("enabled"===t.headers.get("x-sse-support")&&o.add(e),t.json()))).then((n=>(d(e,n),p(t),s.delete(e),n))).catch((t=>(s.delete(e),Promise.resolve({})))),s.set(e,c)),await c}function p(e){const[r,i,s]=f(e);if(t.backgroundSync&&o.has(r)&&n.EventSource){if(u.has(r))return;const t={src:null,cb:n=>{try{const e=JSON.parse(n.data);d(r,e),t.errors=0}catch(n){y(t,i,s)}},errors:0};u.set(r,t),b(t,i,s)}}function y(t,n,e){if(t.errors++,t.errors>3||t.src&&2===t.src.readyState){const r=Math.pow(3,t.errors-3)*(1e3+1e3*Math.random());m(t),setTimeout((()=>{b(t,n,e)}),Math.min(r,3e5))}}function m(t){t.src&&(t.src.onopen=null,t.src.onerror=null,t.src.close(),t.src=null)}function b(t,e,r){t.src=new n.EventSource("".concat(e,"/sub/").concat(r)),t.src.addEventListener("features",t.cb),t.src.onerror=()=>{y(t,e,r)},t.src.onopen=()=>{t.errors=0}}function g(t,n){m(t),u.delete(n)}function _(){o.clear(),u.forEach(g),e.clear()}var $=/^[a-zA-Z:_][a-zA-Z0-9:_.-]*$/,A={revert:function(){}},S=new Map,O=new Set;function x(t){var n=S.get(t);return n||S.set(t,n={element:t,attributes:{}}),n}function E(t,n,e,r,i){var s=e(t),u={isDirty:!1,originalValue:s,virtualValue:s,mutations:[],el:t,observer:new MutationObserver((function(){var n=e(t);n!==u.virtualValue&&(u.originalValue=n,i(u))})),mutationRunner:i,setValue:r,getCurrentValue:e};return u.observer.observe(t,function(t){return"html"===t?{childList:!0,subtree:!0,attributes:!0,characterData:!0}:{childList:!1,subtree:!1,attributes:!0,attributeFilter:[t]}}(n)),u}function F(t,n){var e=n.getCurrentValue(n.el);n.virtualValue=t,t&&"string"!=typeof t?e&&t.parentNode===e.parentNode&&t.insertBeforeNode===e.insertBeforeNode||(n.isDirty=!0,G()):t!==e&&(n.isDirty=!0,G())}function k(t){var n=t.originalValue;t.mutations.forEach((function(t){return n=t.mutate(n)})),F(function(t){return U||(U=document.createElement("div")),U.innerHTML=t,U.innerHTML}(n),t)}function M(t){var n=new Set(t.originalValue.split(/\s+/).filter(Boolean));t.mutations.forEach((function(t){return t.mutate(n)})),F(Array.from(n).filter(Boolean).join(" "),t)}function T(t){var n=t.originalValue;t.mutations.forEach((function(t){return n=t.mutate(n)})),F(n,t)}function N(t){var n=t.originalValue;t.mutations.forEach((function(t){var e=function(t){var n=t.insertBeforeSelector,e=document.querySelector(t.parentSelector);if(!e)return null;var r=n?document.querySelector(n):null;return n&&!r?null:{parentNode:e,insertBeforeNode:r}}(t.mutate());n=e||n})),F(n,t)}var V=function(t){return t.innerHTML},R=function(t,n){return t.innerHTML=n};function C(t){var n=x(t);return n.html||(n.html=E(t,"html",V,R,k)),n.html}var J=function(t){return{parentNode:t.parentElement,insertBeforeNode:t.nextElementSibling}},D=function(t,n){n.parentNode.insertBefore(t,n.insertBeforeNode)};function I(t){var n=x(t);return n.position||(n.position=E(t,"position",J,D,N)),n.position}var U,j=function(t,n){return n?t.className=n:t.removeAttribute("class")},B=function(t){return t.className};function L(t){var n=x(t);return n.classes||(n.classes=E(t,"class",B,j,M)),n.classes}function q(t,n){var e,r=x(t);return r.attributes[n]||(r.attributes[n]=E(t,n,(e=n,function(t){var n;return null!=(n=t.getAttribute(e))?n:null}),function(t){return function(n,e){return null!==e?n.setAttribute(t,e):n.removeAttribute(t)}}(n),T)),r.attributes[n]}function z(t,n,e){if(e.isDirty){e.isDirty=!1;var r=e.virtualValue;e.mutations.length||function(t,n){var e,r,i=S.get(t);if(i)if("html"===n)null==(e=i.html)||null==(r=e.observer)||r.disconnect(),delete i.html;else if("class"===n){var s,u;null==(s=i.classes)||null==(u=s.observer)||u.disconnect(),delete i.classes}else if("position"===n){var o,c;null==(o=i.position)||null==(c=o.observer)||c.disconnect(),delete i.position}else{var a,l,h;null==(a=i.attributes)||null==(l=a[n])||null==(h=l.observer)||h.disconnect(),delete i.attributes[n]}}(t,n),e.setValue(t,r)}}var P,H=!1;function K(t,n){t.html&&z(n,"html",t.html),t.classes&&z(n,"class",t.classes),t.position&&z(n,"position",t.position),Object.keys(t.attributes).forEach((function(e){z(n,e,t.attributes[e])}))}function Z(){H=!1,S.forEach(K)}function G(){H||(H=!0,requestAnimationFrame(Z))}function Q(t,n){var e=null;if("html"===t.kind?e=C(n):"class"===t.kind?e=L(n):"attribute"===t.kind?e=q(n,t.attribute):"position"===t.kind&&(e=I(n)),e){var r=e.mutations.indexOf(t);-1!==r&&e.mutations.splice(r,1),e.mutationRunner(e)}}function W(t){var n=new Set(t.elements),e=new Set;document.querySelectorAll(t.selector).forEach((function(r){e.add(r),n.has(r)||(t.elements.add(r),function(t,n){var e=null;"html"===t.kind?e=C(n):"class"===t.kind?e=L(n):"attribute"===t.kind?e=q(n,t.attribute):"position"===t.kind&&(e=I(n)),e&&(e.mutations.push(t),e.mutationRunner(e))}(t,r))})),n.forEach((function(n){e.has(n)||(t.elements.delete(n),Q(t,n))}))}function X(){O.forEach(W)}function Y(t){return"undefined"==typeof document?A:(O.add(t),W(t),{revert:function(){var n;(n=t).elements.forEach((function(t){return Q(n,t)})),n.elements.clear(),O.delete(n)}})}function tt(t,n){return Y({kind:"html",elements:new Set,mutate:n,selector:t})}function nt(t,n){return Y({kind:"class",elements:new Set,mutate:n,selector:t})}function et(t,n,e){return $.test(n)?"class"===n||"className"===n?nt(t,(function(t){var n=e(Array.from(t).join(" "));t.clear(),n&&n.split(/\s+/g).filter(Boolean).forEach((function(n){return t.add(n)}))})):Y({kind:"attribute",attribute:n,elements:new Set,mutate:e,selector:t}):A}function rt(t){let n=2166136261;const e=t.length;for(let r=0;r<e;r++)n^=t.charCodeAt(r),n+=(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24);return n>>>0}function it(t,n,e){return 2===e?rt(rt(t+n)+"")%1e4/1e4:1===e?rt(n+t)%1e3/1e3:null}function st(t,n){return t>=n[0]&&t<n[1]}function ut(t){try{const n=t.replace(/([^\\])\//g,"$1\\/");return new RegExp(n)}catch(t){return void console.error(t)}}function ot(t,n){if(!n.length)return!1;let e=!1,r=!1;for(let i=0;i<n.length;i++){const s=ct(t,n[i].type,n[i].pattern);if(!1===n[i].include){if(s)return!1}else e=!0,s&&(r=!0)}return r||!e}function ct(t,n,e){try{const r=new URL(t,"https://_");if("regex"===n){const t=ut(e);return!!t&&(t.test(r.href)||t.test(r.href.substring(r.origin.length)))}return"simple"===n&&function(t,n){try{const e=new URL(n.replace(/^([^:/?]*)\./i,"https://$1.").replace(/\*/g,"_____"),"https://_____"),r=[[t.host,e.host,!1],[t.pathname,e.pathname,!0]];return e.hash&&r.push([t.hash,e.hash,!1]),e.searchParams.forEach(((n,e)=>{r.push([t.searchParams.get(e)||"",n,!1])})),!r.some((t=>!function(t,n,e){try{let r=n.replace(/[*.+?^${}()|[\]\\]/g,"\\$&").replace(/_____/g,".*");return e&&(r="\\/?"+r.replace(/(^\/|\/$)/g,"")+"\\/?"),new RegExp("^"+r+"$","i").test(t)}catch(t){return!1}}(t[0],t[1],t[2])))}catch(t){return!1}}(r,e)}catch(t){return!1}}"undefined"!=typeof document&&(P||(P=new MutationObserver((function(){X()}))),X(),P.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!1,characterData:!1}));const at=t=>Uint8Array.from(atob(t),(t=>t.charCodeAt(0)));async function lt(t,n,e){if(n=n||"",!(e=e||globalThis.crypto&&globalThis.crypto.subtle))throw new Error("No SubtleCrypto implementation found");try{const r=await e.importKey("raw",at(n),{name:"AES-CBC",length:128},!0,["encrypt","decrypt"]),[i,s]=t.split("."),u=await e.decrypt({name:"AES-CBC",iv:at(i)},r,at(s));return(new TextDecoder).decode(u)}catch(t){throw new Error("Failed to decrypt")}}function ht(t){const n=t.replace(/(^v|\+.*$)/g,"").split(/[-.]/);return 3===n.length&&n.push("~"),n.map((t=>t.match(/^[0-9]+$/)?t.padStart(5," "):t)).join("-")}const ft={};function dt(t,n){if("$or"in n)return bt(t,n.$or);if("$nor"in n)return!bt(t,n.$nor);if("$and"in n)return function(t,n){for(let e=0;e<n.length;e++)if(!dt(t,n[e]))return!1;return!0}(t,n.$and);if("$not"in n)return!dt(t,n.$not);for(const[e,r]of Object.entries(n))if(!wt(r,vt(t,e)))return!1;return!0}function vt(t,n){const e=n.split(".");let r=t;for(let t=0;t<e.length;t++){if(!r||"object"!=typeof r||!(e[t]in r))return null;r=r[e[t]]}return r}function wt(t,n){if("string"==typeof t)return n+""===t;if("number"==typeof t)return 1*n===t;if("boolean"==typeof t)return!!n===t;if(null===t)return null===n;if(Array.isArray(t)||!pt(t))return JSON.stringify(n)===JSON.stringify(t);for(const e in t)if(!mt(e,n,t[e]))return!1;return!0}function pt(t){const n=Object.keys(t);return n.length>0&&n.filter((t=>"$"===t[0])).length===n.length}function yt(t,n){return Array.isArray(t)?t.some((t=>n.includes(t))):n.includes(t)}function mt(t,n,e){switch(t){case"$veq":return ht(n)===ht(e);case"$vne":return ht(n)!==ht(e);case"$vgt":return ht(n)>ht(e);case"$vgte":return ht(n)>=ht(e);case"$vlt":return ht(n)<ht(e);case"$vlte":return ht(n)<=ht(e);case"$eq":return n===e;case"$ne":return n!==e;case"$lt":return n<e;case"$lte":return n<=e;case"$gt":return n>e;case"$gte":return n>=e;case"$exists":return e?null!==n:null===n;case"$in":return!!Array.isArray(e)&&yt(n,e);case"$nin":return!!Array.isArray(e)&&!yt(n,e);case"$not":return!wt(e,n);case"$size":return!!Array.isArray(n)&&wt(e,n.length);case"$elemMatch":return function(t,n){if(!Array.isArray(t))return!1;const e=pt(n)?t=>wt(n,t):t=>dt(t,n);for(let n=0;n<t.length;n++)if(t[n]&&e(t[n]))return!0;return!1}(n,e);case"$all":if(!Array.isArray(n))return!1;for(let t=0;t<e.length;t++){let r=!1;for(let i=0;i<n.length;i++)if(wt(e[t],n[i])){r=!0;break}if(!r)return!1}return!0;case"$regex":try{return(r=e,ft[r]||(ft[r]=new RegExp(r.replace(/([^\\])\//g,"$1\\/"))),ft[r]).test(n)}catch(t){return!1}case"$type":return function(t){if(null===t)return"null";if(Array.isArray(t))return"array";const n=typeof t;return["string","number","boolean","object","undefined"].includes(n)?n:"unknown"}(n)===e;default:return console.error("Unknown operator: "+t),!1}var r}function bt(t,n){if(!n.length)return!0;for(let e=0;e<n.length;e++)if(dt(t,n[e]))return!0;return!1}const gt="undefined"!=typeof window&&"undefined"!=typeof document;class _t{constructor(t){this.t=this.context=t=t||{},this.i=null,this.u=new Set,this.o={},this.debug=!1,this.l=new Set,this.h=[],this.v=0,this.ready=!1,this.p=new Map,this.m=new Map,this.g={},this._=new Map,t.features&&(this.ready=!0),gt&&t.enableDevMode&&(window._growthbook=this,document.dispatchEvent(new Event("gbloaded"))),t.experiments&&(this.ready=!0,this.$()),t.clientKey&&this.A({},!0,!1)}async loadFeatures(t){await this.A(t,!0,!0),t&&t.autoRefresh&&function(t){const[n]=f(t),r=e.get(n)||new Set;r.add(t),e.set(n,r)}(this)}async refreshFeatures(t){await this.A(t,!1,!0)}getApiInfo(){return[(this.t.apiHost||"https://cdn.growthbook.io").replace(/\/*$/,""),this.t.clientKey||""]}async A(e,s,u){if(e=e||{},!this.t.clientKey)throw new Error("Missing clientKey");await async function(e,s,u,o,c){const a=await async function(e,s,u,o){const[c]=f(e),a=new Date;await async function(){if(!r){r=!0;try{if(n.localStorage){const e=await n.localStorage.getItem(t.cacheKey);if(e){const t=JSON.parse(e);t&&Array.isArray(t)&&t.forEach((t=>{let[n,e]=t;i.set(n,{...e,staleAt:new Date(e.staleAt)})}))}}}catch(t){}}}();const l=i.get(c);if(l&&!o&&(s||l.staleAt>a))return l.staleAt<a?w(e):p(e),l.data;{const t=await function(t,n){return new Promise((e=>{let r,i=!1;const s=t=>{i||(i=!0,r&&clearTimeout(r),e(t||null))};n&&(r=setTimeout((()=>s()),n)),t.then((t=>s(t))).catch((()=>s()))}))}(w(e),u);return t}}(e,o,s,u);c&&a&&await v(e,a)}(this,e.timeout,e.skipCache||this.t.enableDevMode,s,u)}S(){this.i&&this.i()}setFeatures(t){this.t.features=t,this.ready=!0,this.S()}async setEncryptedFeatures(t,n,e){const r=await lt(t,n||this.t.decryptionKey,e);this.setFeatures(JSON.parse(r))}setExperiments(t){this.t.experiments=t,this.ready=!0,this.$()}async setEncryptedExperiments(t,n,e){const r=await lt(t,n||this.t.decryptionKey,e);this.setExperiments(JSON.parse(r))}setAttributes(t){this.t.attributes=t,this.S(),this.$()}setAttributeOverrides(t){this.g=t,this.S(),this.$()}setForcedVariations(t){this.t.forcedVariations=t||{},this.S(),this.$()}setForcedFeatures(t){this.m=t,this.S()}setURL(t){this.t.url=t,this.$(!0)}getAttributes(){return{...this.t.attributes,...this.g}}getFeatures(){return this.t.features||{}}getExperiments(){return this.t.experiments||[]}subscribe(t){return this.l.add(t),()=>{this.l.delete(t)}}getAllResults(){return new Map(this.p)}destroy(){var t;this.l.clear(),this.p.clear(),this.u.clear(),this.o={},this.h=[],this.v&&clearTimeout(this.v),t=this,e.forEach((n=>n.delete(t))),gt&&window._growthbook===this&&delete window._growthbook,this._.forEach((t=>{t.undo()})),this._.clear()}setRenderer(t){this.i=t}forceVariation(t,n){this.t.forcedVariations=this.t.forcedVariations||{},this.t.forcedVariations[t]=n,this.S()}run(t){const n=this.O(t,null);return this.F(t,n),n}triggerExperiment(t){if(!this.t.experiments)return null;const n=this.t.experiments.find((n=>n.key===t));return n&&n.manual?this.k(n,!0):null}k(t,n,e){const r=t.key,i=this._.get(r);if(t.manual&&!n&&!i)return null;const s=this.run(t),u=JSON.stringify(s.value);if(!e&&s.inExperiment&&i&&i.valueHash===u)return s;if(i&&this.M(r),s.inExperiment){const n=this.T(s.value);n&&this._.set(t.key,{undo:n,valueHash:u})}return s}M(t){const n=this._.get(t);n&&(n.undo(),this._.delete(t))}$(t){const n=this.t.experiments||[],e=new Set(n.map((t=>t.key)));this._.forEach(((t,n)=>{e.has(n)||(t.undo(),this._.delete(n))})),n.forEach((n=>{this.k(n,!1,t)}))}F(t,n){const e=t.key,r=this.p.get(e);r&&r.result.inExperiment===n.inExperiment&&r.result.variationId===n.variationId||(this.p.set(e,{experiment:t,result:n}),this.l.forEach((e=>{try{e(t,n)}catch(t){console.error(t)}})))}N(t,n){if("override"===n.source)return;const e=JSON.stringify(n.value);if(this.o[t]!==e){if(this.o[t]=e,this.t.onFeatureUsage)try{this.t.onFeatureUsage(t,n)}catch(t){}gt&&window.fetch&&(this.h.push({key:t,on:n.on}),this.v||(this.v=window.setTimeout((()=>{this.v=0;const t=[...this.h];this.h=[],this.t.realtimeKey&&window.fetch("https://rt.growthbook.io/?key=".concat(this.t.realtimeKey,"&events=").concat(encodeURIComponent(JSON.stringify(t))),{cache:"no-cache",mode:"no-cors"}).catch((()=>{}))}),this.t.realtimeInterval||2e3)))}}V(t,n,e,r,i,s){const u={value:n,on:!!n,off:!n,source:e,ruleId:r||""};return i&&(u.experiment=i),s&&(u.experimentResult=s),this.N(t,u),u}isOn(t){return this.evalFeature(t).on}isOff(t){return this.evalFeature(t).off}getFeatureValue(t,n){const e=this.evalFeature(t).value;return null===e?n:e}feature(t){return this.evalFeature(t)}evalFeature(t){if(this.m.has(t))return this.V(t,this.m.get(t),"override");if(!this.t.features||!this.t.features[t])return this.V(t,null,"unknownFeature");const n=this.t.features[t];if(n.rules)for(const e of n.rules){if(e.condition&&!this.R(e.condition))continue;if(e.filters&&this.C(e.filters))continue;if("force"in e){if(!this.J(e.seed||t,e.hashAttribute,e.range,e.coverage,e.hashVersion))continue;return e.tracks&&e.tracks.forEach((t=>{this.D(t.experiment,t.result)})),this.V(t,e.force,"force",e.id)}if(!e.variations)continue;const n={variations:e.variations,key:e.key||t};"coverage"in e&&(n.coverage=e.coverage),e.weights&&(n.weights=e.weights),e.hashAttribute&&(n.hashAttribute=e.hashAttribute),e.namespace&&(n.namespace=e.namespace),e.meta&&(n.meta=e.meta),e.ranges&&(n.ranges=e.ranges),e.name&&(n.name=e.name),e.phase&&(n.phase=e.phase),e.seed&&(n.seed=e.seed),e.hashVersion&&(n.hashVersion=e.hashVersion),e.filters&&(n.filters=e.filters);const r=this.O(n,t);if(this.F(n,r),r.inExperiment&&!r.passthrough)return this.V(t,r.value,"experiment",e.id,n,r)}return this.V(t,void 0===n.defaultValue?null:n.defaultValue,"defaultValue")}J(t,n,e,r,i){if(!e&&void 0===r)return!0;const{hashValue:s}=this.I(n);if(!s)return!1;const u=it(t,s,i||1);return null!==u&&(e?st(u,e):void 0===r||u<=r)}R(t){return dt(this.getAttributes(),t)}C(t){return t.some((t=>{const{hashValue:n}=this.I(t.attribute);if(!n)return!0;const e=it(t.seed,n,t.hashVersion||2);return null===e||!t.ranges.some((t=>st(e,t)))}))}O(t,n){const e=t.key,r=t.variations.length;if(r<2)return this.U(t,-1,!1,n);if(!1===this.t.enabled)return this.U(t,-1,!1,n);t=this.j(t);const i=function(t,n,e){if(!n)return null;const r=n.split("?")[1];if(!r)return null;const i=r.replace(/#.*/,"").split("&").map((t=>t.split("=",2))).filter((n=>{let[e]=n;return e===t})).map((t=>{let[,n]=t;return parseInt(n)}));return i.length>0&&i[0]>=0&&i[0]<e?i[0]:null}(e,this.B(),r);if(null!==i)return this.U(t,i,!1,n);if(this.t.forcedVariations&&e in this.t.forcedVariations)return this.U(t,this.t.forcedVariations[e],!1,n);if("draft"===t.status||!1===t.active)return this.U(t,-1,!1,n);const{hashValue:s}=this.I(t.hashAttribute);if(!s)return this.U(t,-1,!1,n);if(t.filters){if(this.C(t.filters))return this.U(t,-1,!1,n)}else if(t.namespace&&!function(t,n){const e=it("__"+n[0],t,1);return null!==e&&e>=n[1]&&e<n[2]}(s,t.namespace))return this.U(t,-1,!1,n);if(t.include&&!function(t){try{return t()}catch(t){return console.error(t),!1}}(t.include))return this.U(t,-1,!1,n);if(t.condition&&!this.R(t.condition))return this.U(t,-1,!1,n);if(t.groups&&!this.L(t.groups))return this.U(t,-1,!1,n);if(t.url&&!this.q(t.url))return this.U(t,-1,!1,n);if(t.urlPatterns&&!ot(this.B(),t.urlPatterns))return this.U(t,-1,!1,n);const u=it(t.seed||e,s,t.hashVersion||1);if(null===u)return this.U(t,-1,!1,n);const o=function(t,n){for(let e=0;e<n.length;e++)if(st(t,n[e]))return e;return-1}(u,t.ranges||function(t,n,e){(n=void 0===n?1:n)<0?n=0:n>1&&(n=1);const r=(i=t)<=0?[]:new Array(i).fill(1/i);var i;(e=e||r).length!==t&&(e=r);const s=e.reduce(((t,n)=>n+t),0);(s<.99||s>1.01)&&(e=r);let u=0;return e.map((t=>{const e=u;return u+=t,[e,e+n*t]}))}(r,void 0===t.coverage?1:t.coverage,t.weights));if(o<0)return this.U(t,-1,!1,n);if("force"in t)return this.U(t,void 0===t.force?-1:t.force,!1,n);if(this.t.qaMode)return this.U(t,-1,!1,n);if("stopped"===t.status)return this.U(t,-1,!1,n);const c=this.U(t,o,!0,n,u);return this.D(t,c),c}log(t,n){this.debug&&(this.t.log?this.t.log(t,n):console.log(t,n))}D(t,n){if(!this.t.trackingCallback)return;const e=n.hashAttribute+n.hashValue+t.key+n.variationId;if(!this.u.has(e)){this.u.add(e);try{this.t.trackingCallback(t,n)}catch(t){console.error(t)}}}j(t){const n=t.key,e=this.t.overrides;return e&&e[n]&&"string"==typeof(t=Object.assign({},t,e[n])).url&&(t.url=ut(t.url)),t}I(t){const n=t||"id";let e="";return this.g[n]?e=this.g[n]:this.t.attributes?e=this.t.attributes[n]||"":this.t.user&&(e=this.t.user[n]||""),{hashAttribute:n,hashValue:e}}U(t,n,e,r,i){let s=!0;(n<0||n>=t.variations.length)&&(n=0,s=!1);const{hashAttribute:u,hashValue:o}=this.I(t.hashAttribute),c=t.meta?t.meta[n]:{},a={key:c.key||""+n,featureId:r,inExperiment:s,hashUsed:e,variationId:n,value:t.variations[n],hashAttribute:u,hashValue:o};return c.name&&(a.name=c.name),void 0!==i&&(a.bucket=i),c.passthrough&&(a.passthrough=c.passthrough),a}B(){return this.t.url||(gt?window.location.href:"")}q(t){const n=this.B();if(!n)return!1;const e=n.replace(/^https?:\/\//,"").replace(/^[^/]*\//,"/");return!!t.test(n)||!!t.test(e)}L(t){const n=this.t.groups||{};for(let e=0;e<t.length;e++)if(n[t[e]])return!0;return!1}T(t){if(!gt)return;const n=[];if(t.css){const e=document.createElement("style");e.innerHTML=t.css,document.head.appendChild(e),n.push((()=>e.remove()))}if(t.js){const e=document.createElement("script");e.innerHTML=t.js,document.body.appendChild(e),n.push((()=>e.remove()))}return t.domMutations&&t.domMutations.forEach((t=>{n.push(function(t){var n=t.selector,e=t.action,r=t.value,i=t.attribute,s=t.parentSelector,u=t.insertBeforeSelector;if("html"===i){if("append"===e)return tt(n,(function(t){return t+(null!=r?r:"")}));if("set"===e)return tt(n,(function(){return null!=r?r:""}))}else if("class"===i){if("append"===e)return nt(n,(function(t){r&&t.add(r)}));if("remove"===e)return nt(n,(function(t){r&&t.delete(r)}));if("set"===e)return nt(n,(function(t){t.clear(),r&&t.add(r)}))}else if("position"===i){if("set"===e&&s)return function(t,n){return Y({kind:"position",elements:new Set,mutate:function(){return{insertBeforeSelector:u,parentSelector:s}},selector:t})}(n)}else{if("append"===e)return et(n,i,(function(t){return null!==t?t+(null!=r?r:""):null!=r?r:""}));if("set"===e)return et(n,i,(function(){return null!=r?r:""}));if("remove"===e)return et(n,i,(function(){return null}))}return A}(t).revert)})),()=>{n.forEach((t=>t()))}}}export{_t as GrowthBook,l as clearCache,a as configureCache,ot as isURLTargeted,c as setPolyfills};
//# sourceMappingURL=esm.min.js.map
